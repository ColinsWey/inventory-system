-- Начальные данные для системы управления товарными остатками
-- Дата: 2024-01-15

-- Создание администратора
INSERT INTO users (id, username, email, hashed_password, first_name, last_name, role, is_active) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440000',
    'admin', 
    'admin@inventory.local', 
    '$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW', -- пароль: admin
    'Администратор',
    'Системы',
    'admin',
    true
);

-- Создание тестового менеджера
INSERT INTO users (id, username, email, hashed_password, first_name, last_name, role, is_active) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440001',
    'manager', 
    'manager@inventory.local', 
    '$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW', -- пароль: admin
    'Менеджер',
    'Склада',
    'manager',
    true
);

-- Основные категории товаров
INSERT INTO categories (id, name, description, sort_order, is_active) VALUES 
('550e8400-e29b-41d4-a716-446655440100', 'Электроника', 'Электронные устройства и компоненты', 1, true),
('550e8400-e29b-41d4-a716-446655440101', 'Одежда', 'Одежда и аксессуары', 2, true),
('550e8400-e29b-41d4-a716-446655440102', 'Книги', 'Книги и печатные издания', 3, true),
('550e8400-e29b-41d4-a716-446655440103', 'Спорт', 'Спортивные товары и оборудование', 4, true),
('550e8400-e29b-41d4-a716-446655440104', 'Дом и сад', 'Товары для дома и сада', 5, true);

-- Подкатегории
INSERT INTO categories (id, name, description, parent_id, sort_order, is_active) VALUES 
('550e8400-e29b-41d4-a716-446655440110', 'Смартфоны', 'Мобильные телефоны', '550e8400-e29b-41d4-a716-446655440100', 1, true),
('550e8400-e29b-41d4-a716-446655440111', 'Ноутбуки', 'Портативные компьютеры', '550e8400-e29b-41d4-a716-446655440100', 2, true),
('550e8400-e29b-41d4-a716-446655440112', 'Мужская одежда', 'Одежда для мужчин', '550e8400-e29b-41d4-a716-446655440101', 1, true),
('550e8400-e29b-41d4-a716-446655440113', 'Женская одежда', 'Одежда для женщин', '550e8400-e29b-41d4-a716-446655440101', 2, true);

-- Теги товаров
INSERT INTO product_tags (id, name, color, description) VALUES 
('550e8400-e29b-41d4-a716-446655440200', 'Новинка', '#22C55E', 'Новые поступления'),
('550e8400-e29b-41d4-a716-446655440201', 'Акция', '#EF4444', 'Товары по акции'),
('550e8400-e29b-41d4-a716-446655440202', 'Хит продаж', '#F59E0B', 'Популярные товары'),
('550e8400-e29b-41d4-a716-446655440203', 'Сезонный', '#3B82F6', 'Сезонные товары'),
('550e8400-e29b-41d4-a716-446655440204', 'Эксклюзив', '#8B5CF6', 'Эксклюзивные товары');

-- Поставщики
INSERT INTO suppliers (id, name, code, contact_person, email, phone, address, city, tax_id, payment_terms, rating) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440300',
    'ООО "ТехноСнаб"',
    'TECH001',
    'Иванов Иван Иванович',
    'ivan@technosnab.ru',
    '+7-495-123-45-67',
    'ул. Технологическая, д. 15',
    'Москва',
    '7701234567',
    30,
    4.8
),
(
    '550e8400-e29b-41d4-a716-446655440301',
    'ИП Петров П.П.',
    'PETR001',
    'Петров Петр Петрович',
    'petr@petrov.ru',
    '+7-812-987-65-43',
    'пр. Невский, д. 100',
    'Санкт-Петербург',
    '780123456789',
    14,
    4.5
),
(
    '550e8400-e29b-41d4-a716-446655440302',
    'ООО "МегаТорг"',
    'MEGA001',
    'Сидорова Анна Владимировна',
    'anna@megatorg.ru',
    '+7-383-555-12-34',
    'ул. Торговая, д. 25',
    'Новосибирск',
    '5401234567',
    21,
    4.2
);

-- Товары
INSERT INTO products (id, name, sku, barcode, category_id, supplier_id, description, unit_price, cost_price, weight, unit_of_measure, status) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440400',
    'iPhone 15 Pro 128GB',
    'IPHONE15PRO128',
    '1234567890123',
    '550e8400-e29b-41d4-a716-446655440110',
    '550e8400-e29b-41d4-a716-446655440300',
    'Смартфон Apple iPhone 15 Pro с памятью 128GB',
    89990.00,
    75000.00,
    0.187,
    'шт',
    'active'
),
(
    '550e8400-e29b-41d4-a716-446655440401',
    'MacBook Air M2 256GB',
    'MACBOOKAIRM2256',
    '1234567890124',
    '550e8400-e29b-41d4-a716-446655440111',
    '550e8400-e29b-41d4-a716-446655440300',
    'Ноутбук Apple MacBook Air с чипом M2 и SSD 256GB',
    119990.00,
    95000.00,
    1.24,
    'шт',
    'active'
),
(
    '550e8400-e29b-41d4-a716-446655440402',
    'Рубашка мужская классическая',
    'SHIRT-M-CLASSIC-001',
    '1234567890125',
    '550e8400-e29b-41d4-a716-446655440112',
    '550e8400-e29b-41d4-a716-446655440301',
    'Классическая мужская рубашка из хлопка',
    2990.00,
    1500.00,
    0.3,
    'шт',
    'active'
),
(
    '550e8400-e29b-41d4-a716-446655440403',
    'Платье женское летнее',
    'DRESS-W-SUMMER-001',
    '1234567890126',
    '550e8400-e29b-41d4-a716-446655440113',
    '550e8400-e29b-41d4-a716-446655440301',
    'Легкое летнее платье из натуральных материалов',
    4500.00,
    2200.00,
    0.4,
    'шт',
    'active'
),
(
    '550e8400-e29b-41d4-a716-446655440404',
    'Книга "Программирование на Python"',
    'BOOK-PYTHON-001',
    '9785123456789',
    '550e8400-e29b-41d4-a716-446655440102',
    '550e8400-e29b-41d4-a716-446655440302',
    'Учебник по программированию на языке Python',
    1200.00,
    800.00,
    0.5,
    'шт',
    'active'
);

-- Связи товаров с тегами
INSERT INTO product_tag_relations (product_id, tag_id) VALUES 
('550e8400-e29b-41d4-a716-446655440400', '550e8400-e29b-41d4-a716-446655440200'), -- iPhone - Новинка
('550e8400-e29b-41d4-a716-446655440400', '550e8400-e29b-41d4-a716-446655440202'), -- iPhone - Хит продаж
('550e8400-e29b-41d4-a716-446655440401', '550e8400-e29b-41d4-a716-446655440200'), -- MacBook - Новинка
('550e8400-e29b-41d4-a716-446655440402', '550e8400-e29b-41d4-a716-446655440201'), -- Рубашка - Акция
('550e8400-e29b-41d4-a716-446655440403', '550e8400-e29b-41d4-a716-446655440203'), -- Платье - Сезонный
('550e8400-e29b-41d4-a716-446655440404', '550e8400-e29b-41d4-a716-446655440202'); -- Книга - Хит продаж

-- Складские остатки (автоматически создаются триггером, но добавим данные)
UPDATE inventory SET 
    quantity = 25,
    min_quantity = 5,
    max_quantity = 100,
    reorder_point = 10
WHERE product_id = '550e8400-e29b-41d4-a716-446655440400';

UPDATE inventory SET 
    quantity = 15,
    min_quantity = 3,
    max_quantity = 50,
    reorder_point = 8
WHERE product_id = '550e8400-e29b-41d4-a716-446655440401';

UPDATE inventory SET 
    quantity = 45,
    min_quantity = 10,
    max_quantity = 200,
    reorder_point = 20
WHERE product_id = '550e8400-e29b-41d4-a716-446655440402';

UPDATE inventory SET 
    quantity = 8,
    min_quantity = 15,
    max_quantity = 150,
    reorder_point = 25
WHERE product_id = '550e8400-e29b-41d4-a716-446655440403';

UPDATE inventory SET 
    quantity = 120,
    min_quantity = 20,
    max_quantity = 500,
    reorder_point = 50
WHERE product_id = '550e8400-e29b-41d4-a716-446655440404';

-- Шаблоны прогнозирования
INSERT INTO forecast_templates (id, name, description, category_id, seasonal_factors, trend_factor, is_active) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440500',
    'Электроника - стандартный',
    'Стандартный шаблон для электроники',
    '550e8400-e29b-41d4-a716-446655440100',
    '{"1": 0.9, "2": 0.8, "3": 1.0, "4": 1.1, "5": 1.2, "6": 1.0, "7": 0.9, "8": 0.8, "9": 1.1, "10": 1.3, "11": 1.5, "12": 1.8}',
    1.0500,
    true
),
(
    '550e8400-e29b-41d4-a716-446655440501',
    'Одежда - сезонный',
    'Сезонный шаблон для одежды',
    '550e8400-e29b-41d4-a716-446655440101',
    '{"1": 0.7, "2": 0.8, "3": 1.2, "4": 1.4, "5": 1.3, "6": 1.1, "7": 0.9, "8": 0.8, "9": 1.3, "10": 1.4, "11": 1.2, "12": 1.0}',
    1.0200,
    true
);

-- Конфигурация интеграций
INSERT INTO integration_config (id, service_name, config_data, is_enabled) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440600',
    'salesdrive',
    '{"api_url": "https://api.salesdrive.ru", "api_key": "test_key", "sync_interval": 60, "auto_sync": true, "timeout": 30}',
    true
),
(
    '550e8400-e29b-41d4-a716-446655440601',
    'email_notifications',
    '{"smtp_host": "smtp.gmail.com", "smtp_port": 587, "username": "notifications@inventory.local", "enabled": true}',
    true
);

-- Тестовые заказы
INSERT INTO orders (id, order_number, customer_name, customer_email, customer_phone, status, order_date, total_amount, created_by) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440700',
    'ORD-2024-001',
    'Иванов Сергей Петрович',
    'sergey.ivanov@email.com',
    '+7-903-123-45-67',
    'confirmed',
    '2024-01-10 10:30:00',
    92980.00,
    '550e8400-e29b-41d4-a716-446655440000'
),
(
    '550e8400-e29b-41d4-a716-446655440701',
    'ORD-2024-002',
    'Петрова Анна Владимировна',
    'anna.petrova@email.com',
    '+7-916-987-65-43',
    'pending',
    '2024-01-12 14:15:00',
    7490.00,
    '550e8400-e29b-41d4-a716-446655440001'
);

-- Позиции заказов
INSERT INTO order_items (id, order_id, product_id, quantity, unit_price, total_amount) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440800',
    '550e8400-e29b-41d4-a716-446655440700',
    '550e8400-e29b-41d4-a716-446655440400',
    1,
    89990.00,
    89990.00
),
(
    '550e8400-e29b-41d4-a716-446655440801',
    '550e8400-e29b-41d4-a716-446655440700',
    '550e8400-e29b-41d4-a716-446655440402',
    1,
    2990.00,
    2990.00
),
(
    '550e8400-e29b-41d4-a716-446655440802',
    '550e8400-e29b-41d4-a716-446655440701',
    '550e8400-e29b-41d4-a716-446655440403',
    1,
    4500.00,
    4500.00
),
(
    '550e8400-e29b-41d4-a716-446655440803',
    '550e8400-e29b-41d4-a716-446655440701',
    '550e8400-e29b-41d4-a716-446655440402',
    1,
    2990.00,
    2990.00
);

-- Движения товаров
INSERT INTO inventory_movements (id, product_id, location, movement_type, quantity, unit_price, total_amount, reason, reference_number, created_by) VALUES 
(
    '550e8400-e29b-41d4-a716-446655440900',
    '550e8400-e29b-41d4-a716-446655440400',
    'Основной склад',
    'in',
    30,
    75000.00,
    2250000.00,
    'Поступление от поставщика',
    'DOC-2024-001',
    '550e8400-e29b-41d4-a716-446655440000'
),
(
    '550e8400-e29b-41d4-a716-446655440901',
    '550e8400-e29b-41d4-a716-446655440400',
    'Основной склад',
    'out',
    5,
    89990.00,
    449950.00,
    'Продажа клиентам',
    'SALE-2024-001',
    '550e8400-e29b-41d4-a716-446655440001'
);

-- Уведомления
INSERT INTO alerts (id, product_id, alert_type, level, title, message, is_read) VALUES 
(
    '550e8400-e29b-41d4-a716-446655441000',
    '550e8400-e29b-41d4-a716-446655440403',
    'low_stock',
    'warning',
    'Низкий остаток товара',
    'Остаток товара "Платье женское летнее" (8 шт.) ниже минимального уровня (15 шт.)',
    false
),
(
    '550e8400-e29b-41d4-a716-446655441001',
    '550e8400-e29b-41d4-a716-446655440401',
    'reorder_needed',
    'info',
    'Необходимо пополнение',
    'Рекомендуется заказать товар "MacBook Air M2 256GB" у поставщика',
    false
);

-- Прогнозы продаж (примеры на ближайшие дни)
INSERT INTO sales_forecasts (id, product_id, forecast_date, predicted_quantity, confidence_level, template_id) VALUES 
(
    '550e8400-e29b-41d4-a716-446655441100',
    '550e8400-e29b-41d4-a716-446655440400',
    '2024-01-16',
    3,
    0.85,
    '550e8400-e29b-41d4-a716-446655440500'
),
(
    '550e8400-e29b-41d4-a716-446655441101',
    '550e8400-e29b-41d4-a716-446655440400',
    '2024-01-17',
    2,
    0.82,
    '550e8400-e29b-41d4-a716-446655440500'
),
(
    '550e8400-e29b-41d4-a716-446655441102',
    '550e8400-e29b-41d4-a716-446655440403',
    '2024-01-16',
    5,
    0.78,
    '550e8400-e29b-41d4-a716-446655440501'
);

-- История синхронизации
INSERT INTO sync_history (id, sync_type, status, items_processed, items_updated, items_created, started_at, completed_at, created_by) VALUES 
(
    '550e8400-e29b-41d4-a716-446655441200',
    'salesdrive_auto',
    'success',
    150,
    10,
    5,
    '2024-01-15 09:00:00',
    '2024-01-15 09:05:30',
    '550e8400-e29b-41d4-a716-446655440000'
),
(
    '550e8400-e29b-41d4-a716-446655441201',
    'manual_import',
    'partial',
    25,
    20,
    0,
    '2024-01-14 15:30:00',
    '2024-01-14 15:32:15',
    '550e8400-e29b-41d4-a716-446655440001'
); 